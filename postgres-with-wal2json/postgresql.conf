#------------------------------------------------------------------------------
# PostgreSQL configuration file
#------------------------------------------------------------------------------

#------------------------------------------------------------------------------
# CONNECTIONS AND AUTHENTICATION
#------------------------------------------------------------------------------

# Listen on all addresses (useful if running in Docker)
listen_addresses = '*'

# Maximum number of concurrent connections
max_connections = 100

#------------------------------------------------------------------------------
# RESOURCE USAGE
#------------------------------------------------------------------------------

# Shared memory buffers (typically 25% of available memory)
shared_buffers = 128MB

# Work memory for operations (adjust based on available memory)
work_mem = 4MB

# Maintenance work memory (used for maintenance operations)
maintenance_work_mem = 64MB

#------------------------------------------------------------------------------
# WRITE-AHEAD LOG
#------------------------------------------------------------------------------

# Write-Ahead Log (WAL) settings
wal_level = logical            # Set WAL level to 'logical' for logical replication
max_wal_senders = 4         # Maximum number of replication connections
max_replication_slots = 4      # Number of replication slots for logical replication

#------------------------------------------------------------------------------
# EXTENSIONS
#------------------------------------------------------------------------------

# Preload necessary extensions
shared_preload_libraries = 'pg_stat_statements, wal2json'  # Load the wal2json extension

#------------------------------------------------------------------------------
# LOGGING
#------------------------------------------------------------------------------

# Enable detailed logging for debugging
log_statement = 'all'          # Log all queries (change as needed for production)
log_duration = on              # Log the duration of queries

#------------------------------------------------------------------------------
# AUTOVACUUM
#------------------------------------------------------------------------------

# Enable autovacuum to prevent table bloat
autovacuum = on
autovacuum_vacuum_scale_factor = 0.2
autovacuum_analyze_scale_factor = 0.1

#------------------------------------------------------------------------------
# Other PostgreSQL settings
#------------------------------------------------------------------------------

# Default time zone (you can adjust this to your region)
timezone = 'UTC'